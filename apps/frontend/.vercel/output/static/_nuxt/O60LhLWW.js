import{_ as L}from"./DkiIfuYp.js";import{g as S,m as M,E as N,r as y,y as k,j as R,p as V,c as o,a as t,s as p,l,F as A,v as B,z as c,t as d,A as w,B as F,o as i,n as D,b as q,w as E,d as T}from"./D1Xstx_g.js";import{u as J}from"./DivAE8d_.js";import{u as P}from"./Ba0zKJDI.js";const U={class:"px-4 pt-4 pb-24"},I={key:0,class:"text-center py-12"},G={key:1,class:"text-center py-12"},H={class:"space-y-3"},K={key:2,class:"space-y-4"},O={class:"flex items-center gap-4"},Q=["onClick"],W=["onClick"],X={class:"font-semibold text-gray-900"},Y={class:"flex items-center gap-2 text-sm text-gray-500"},Z={class:"px-2 py-0.5 bg-gray-100 rounded-full text-xs"},ee={key:0,class:"text-primary-500 mr-2"},te={class:"pt-4 border-t border-gray-200 space-y-3"},se={class:"bg-white w-full rounded-t-3xl p-6"},le={key:0,class:"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl text-red-700 text-sm"},ne={class:"flex gap-3"},oe=["disabled"],ie={class:"bg-white w-full rounded-t-3xl p-6"},re={key:0,class:"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl text-red-700 text-sm"},ae={class:"flex gap-3"},de=["disabled"],be=S({__name:"families",setup(ue){const g=J(),n=P(),x=M(),_=N(),u=y(!1),m=y(!1),a=y(""),f=k({name:""}),b=k({inviteCode:""}),v=R(()=>_.query.redirect||"/");function C(r){n.setCurrentFamily(r),x.push(v.value)}async function $(){a.value="";const r=await n.createFamily(f.name);r.success?(u.value=!1,f.name="",r.family&&x.push(v.value)):a.value=r.message}async function j(){a.value="";const r=await n.joinFamily(b.inviteCode);r.success?(m.value=!1,b.inviteCode="",r.family&&x.push(v.value)):a.value=r.message}return V(async()=>{if(g.init(),!g.isLoggedIn){x.push("/login");return}await n.fetchFamilies(),n.loadCurrentFamily()}),(r,e)=>{const h=L;return i(),o("div",U,[e[21]||(e[21]=t("header",{class:"mb-6"},[t("h1",{class:"text-2xl font-bold text-gray-900"},"Mes Familles"),t("p",{class:"text-gray-500"},"SÃ©lectionnez une famille pour continuer")],-1)),l(n).isLoading?(i(),o("div",I,[...e[10]||(e[10]=[t("div",{class:"animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full mx-auto mb-4"},null,-1),t("p",{class:"text-gray-500"},"Chargement...",-1)])])):l(n).hasFamily?(i(),o("div",K,[(i(!0),o(A,null,B(l(n).families,s=>(i(),o("div",{key:s.id,class:D(["card",l(n).currentFamily?.id===s.id?"ring-2 ring-primary-500":""])},[t("div",O,[t("div",{onClick:z=>C(s),class:"w-14 h-14 bg-gradient-to-br from-primary-400 to-primary-600 rounded-xl flex items-center justify-center text-2xl cursor-pointer"}," ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦ ",8,Q),t("div",{onClick:z=>C(s),class:"flex-1 cursor-pointer"},[t("h3",X,d(s.name),1),t("div",Y,[t("span",Z,d(s.role),1),e[14]||(e[14]=t("span",null,"â€¢",-1)),t("span",null,"Code: "+d(s.inviteCode),1)])],8,W),l(n).currentFamily?.id===s.id?(i(),o("div",ee," âœ“ ")):p("",!0),q(h,{to:`/family/${s.id}`,class:"p-2 bg-gray-100 rounded-lg hover:bg-gray-200",title:"ParamÃ¨tres"},{default:E(()=>[...e[15]||(e[15]=[T(" âš™ï¸ ",-1)])]),_:1},8,["to"])])],2))),128)),t("div",te,[t("button",{onClick:e[2]||(e[2]=s=>u.value=!0),class:"w-full btn-outline py-3"}," âž• CrÃ©er une nouvelle famille "),t("button",{onClick:e[3]||(e[3]=s=>m.value=!0),class:"w-full btn-outline py-3"}," ðŸ”— Rejoindre une autre famille ")])])):(i(),o("div",G,[e[11]||(e[11]=t("div",{class:"text-6xl mb-4"},"ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦",-1)),e[12]||(e[12]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Pas encore de famille",-1)),e[13]||(e[13]=t("p",{class:"text-gray-500 mb-6"},"CrÃ©ez une famille ou rejoignez-en une existante",-1)),t("div",H,[t("button",{onClick:e[0]||(e[0]=s=>u.value=!0),class:"w-full btn-primary py-3"}," âž• CrÃ©er une famille "),t("button",{onClick:e[1]||(e[1]=s=>m.value=!0),class:"w-full btn-outline py-3"}," ðŸ”— Rejoindre une famille ")])])),l(u)?(i(),o("div",{key:3,class:"fixed inset-0 bg-black/50 flex items-end z-50",onClick:e[6]||(e[6]=c(s=>u.value=!1,["self"]))},[t("div",se,[e[17]||(e[17]=t("h2",{class:"text-xl font-bold text-gray-900 mb-4"},"CrÃ©er une famille",-1)),l(a)?(i(),o("div",le,d(l(a)),1)):p("",!0),t("form",{onSubmit:c($,["prevent"]),class:"space-y-4"},[t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nom de la famille",-1)),w(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>l(f).name=s),type:"text",required:"",class:"input",placeholder:"Ex: Famille Dupont"},null,512),[[F,l(f).name]])]),t("div",ne,[t("button",{type:"button",onClick:e[5]||(e[5]=s=>u.value=!1),class:"flex-1 btn-outline"}," Annuler "),t("button",{type:"submit",class:"flex-1 btn-primary",disabled:l(n).isLoading},d(l(n).isLoading?"CrÃ©ation...":"CrÃ©er"),9,oe)])],32)])])):p("",!0),l(m)?(i(),o("div",{key:4,class:"fixed inset-0 bg-black/50 flex items-end z-50",onClick:e[9]||(e[9]=c(s=>m.value=!1,["self"]))},[t("div",ie,[e[20]||(e[20]=t("h2",{class:"text-xl font-bold text-gray-900 mb-4"},"Rejoindre une famille",-1)),l(a)?(i(),o("div",re,d(l(a)),1)):p("",!0),t("form",{onSubmit:c(j,["prevent"]),class:"space-y-4"},[t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Code d'invitation",-1)),w(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>l(b).inviteCode=s),type:"text",required:"",class:"input text-center text-lg tracking-widest uppercase",placeholder:"ABCD1234",maxlength:"8"},null,512),[[F,l(b).inviteCode]]),e[19]||(e[19]=t("p",{class:"text-xs text-gray-500 mt-1"},"Demandez le code Ã  un membre de la famille",-1))]),t("div",ae,[t("button",{type:"button",onClick:e[8]||(e[8]=s=>m.value=!1),class:"flex-1 btn-outline"}," Annuler "),t("button",{type:"submit",class:"flex-1 btn-primary",disabled:l(n).isLoading},d(l(n).isLoading?"Connexion...":"Rejoindre"),9,de)])],32)])])):p("",!0)])}}});export{be as default};
