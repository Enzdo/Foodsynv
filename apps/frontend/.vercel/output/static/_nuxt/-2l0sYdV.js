import{_ as M}from"./DkiIfuYp.js";import{u as A}from"./DivAE8d_.js";import{u as L}from"./Ba0zKJDI.js";import{g as S,m as $,E as D,r as c,j as v,p as R,c as n,a as t,l as s,t as r,F as z,v as T,s as y,n as _,b as V,w as E,G as P,o as l,d as b}from"./D1Xstx_g.js";const q={class:"px-4 pt-4 pb-24"},G={class:"flex items-center gap-4 mb-6"},O={class:"text-xl font-bold text-gray-900"},Q={key:0,class:"text-center py-12"},U={key:1},H={class:"card mb-6"},J={class:"flex items-center gap-4 mb-4"},K={class:"flex-1"},W={class:"text-lg font-bold text-gray-900"},X={class:"text-sm text-gray-500"},Y={class:"bg-gray-50 rounded-xl p-4"},Z={class:"flex items-center justify-between"},tt={class:"text-lg font-mono font-bold text-gray-900"},et={class:"mb-6"},st={class:"text-lg font-semibold text-gray-900 mb-3"},ot={class:"space-y-3"},rt={class:"w-12 h-12 bg-gradient-to-br from-gray-300 to-gray-400 rounded-full flex items-center justify-center text-lg text-white font-bold"},at={class:"flex-1"},it={class:"font-medium text-gray-900"},nt={key:0,class:"text-xs text-primary-600"},lt={class:"text-sm text-gray-500"},dt={class:"space-y-3"},ut={key:0,class:"w-full card flex items-center gap-4 py-3 text-left"},ct=["disabled"],mt={class:"flex-1"},ft={key:0,class:"text-xs text-gray-500"},xt={key:2,class:"text-center py-12"},bt=S({__name:"[id]",setup(pt){const d=A(),h=L(),m=$(),w=D(),k=P(),f=c(!0),a=c(null),x=c([]),p=c(!1),g=v(()=>Number(w.params.id)),u=v(()=>a.value?.ownerId===d.user?.id);function C(o){return o.user?`${o.user.firstName?.charAt(0)||""}${o.user.lastName?.charAt(0)||""}`.toUpperCase():"?"}function N(o){return new Date(o).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})}async function j(){a.value&&(await navigator.clipboard.writeText(a.value.inviteCode),p.value=!0,setTimeout(()=>p.value=!1,2e3))}async function F(){if(d.token){f.value=!0;try{const o=await fetch(`${k.public.apiBase}/api/v1/families/${g.value}`,{headers:{Authorization:`Bearer ${d.token}`}});if(o.ok){const e=await o.json();a.value=e.family,x.value=e.family.members||[]}}catch(o){console.error("Error fetching family details:",o)}finally{f.value=!1}}}async function B(){u.value||confirm("ÃŠtes-vous sÃ»r de vouloir quitter cette famille ?")&&(await h.leaveFamily(g.value)).success&&m.push("/families")}return R(async()=>{if(d.init(),!d.isLoggedIn){m.push("/login");return}await F()}),(o,e)=>{const I=M;return l(),n("div",q,[t("header",G,[t("button",{onClick:e[0]||(e[0]=i=>s(m).back()),class:"p-2 bg-gray-100 rounded-xl"},[...e[1]||(e[1]=[t("svg",{class:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),t("div",null,[t("h1",O,r(s(a)?.name||"Famille"),1),e[2]||(e[2]=t("p",{class:"text-gray-500 text-sm"},"ParamÃ¨tres de la famille",-1))])]),s(f)?(l(),n("div",Q,[...e[3]||(e[3]=[t("div",{class:"animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full mx-auto mb-4"},null,-1),t("p",{class:"text-gray-500"},"Chargement...",-1)])])):s(a)?(l(),n("div",U,[t("div",H,[t("div",J,[e[4]||(e[4]=t("div",{class:"w-16 h-16 bg-gradient-to-br from-primary-400 to-primary-600 rounded-xl flex items-center justify-center text-3xl"}," ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦ ",-1)),t("div",K,[t("h2",W,r(s(a).name),1),t("p",X,"CrÃ©Ã©e le "+r(N(s(a).createdAt)),1)])]),t("div",Y,[t("div",Z,[t("div",null,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-500"},"Code d'invitation",-1)),t("p",tt,r(s(a).inviteCode),1)]),t("button",{onClick:j,class:"px-4 py-2 bg-primary-500 text-white rounded-lg text-sm font-medium"},r(s(p)?"âœ“ CopiÃ©":"ðŸ“‹ Copier"),1)]),e[6]||(e[6]=t("p",{class:"text-xs text-gray-500 mt-2"},"Partagez ce code pour inviter des membres",-1))])]),t("section",et,[t("h3",st," ðŸ‘¥ Membres ("+r(s(x).length)+") ",1),t("div",ot,[(l(!0),n(z,null,T(s(x),i=>(l(),n("div",{key:i.id,class:"card flex items-center gap-4"},[t("div",rt,r(C(i)),1),t("div",at,[t("h4",it,[b(r(i.user?.firstName)+" "+r(i.user?.lastName)+" ",1),i.userId===s(a).ownerId?(l(),n("span",nt,"(PropriÃ©taire)")):y("",!0)]),t("p",lt,r(i.user?.email),1)]),t("span",{class:_(["px-2 py-1 text-xs font-medium rounded-full",i.role==="admin"?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600"])},r(i.role==="admin"?"Admin":"Membre"),3)]))),128))])]),t("section",dt,[s(u)?(l(),n("button",ut,[...e[7]||(e[7]=[t("div",{class:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center"}," âœï¸ ",-1),t("span",{class:"flex-1 font-medium text-gray-900"},"Modifier le nom",-1),t("svg",{class:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])])):y("",!0),t("button",{onClick:B,class:_(["w-full card flex items-center gap-4 py-3 text-left",s(u)?"opacity-50":""]),disabled:s(u)},[e[9]||(e[9]=t("div",{class:"w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center"}," ðŸšª ",-1)),t("div",mt,[e[8]||(e[8]=t("span",{class:"font-medium text-red-600"},"Quitter la famille",-1)),s(u)?(l(),n("p",ft,"TransfÃ©rez d'abord la propriÃ©tÃ©")):y("",!0)])],10,ct)])])):(l(),n("div",xt,[e[11]||(e[11]=t("div",{class:"text-6xl mb-4"},"ðŸ˜•",-1)),e[12]||(e[12]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Famille introuvable",-1)),V(I,{to:"/families",class:"text-primary-600 font-medium"},{default:E(()=>[...e[10]||(e[10]=[b("Retour aux familles",-1)])]),_:1})]))])}}});export{bt as default};
