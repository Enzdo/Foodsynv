import{H as l,G as o}from"./D1Xstx_g.js";import{u as c}from"./DivAE8d_.js";import{u as n}from"./Ba0zKJDI.js";const g=l("recipes",{state:()=>({recipes:[],familyRecipes:[],suggestions:[],isLoading:!1}),actions:{async fetchRecipes(){const a=o(),t=c();if(t.token){this.isLoading=!0;try{const s=await fetch(`${a.public.apiBase}/api/v1/recipes`,{headers:{Authorization:`Bearer ${t.token}`}});if(s.ok){const e=await s.json();this.recipes=e.recipes}}catch(s){console.error("Error fetching recipes:",s)}finally{this.isLoading=!1}}},async fetchSuggestions(){const a=o(),t=c(),s=n();if(!(!t.token||!s.currentFamilyId)){this.isLoading=!0;try{const e=await fetch(`${a.public.apiBase}/api/v1/recipes/suggestions?familyId=${s.currentFamilyId}`,{headers:{Authorization:`Bearer ${t.token}`}});if(e.ok){const i=await e.json();this.suggestions=i.suggestions}}catch(e){console.error("Error fetching recipe suggestions:",e)}finally{this.isLoading=!1}}},async fetchFamilyRecipes(){const a=o(),t=c(),s=n();if(!(!t.token||!s.currentFamilyId)){this.isLoading=!0;try{const e=await fetch(`${a.public.apiBase}/api/v1/recipes/family?familyId=${s.currentFamilyId}`,{headers:{Authorization:`Bearer ${t.token}`}});if(e.ok){const i=await e.json();this.familyRecipes=i.recipes}}catch(e){console.error("Error fetching family recipes:",e)}finally{this.isLoading=!1}}},async createFamilyRecipe(a){const t=o(),s=c(),e=n();if(!s.token||!e.currentFamilyId)return{success:!1,message:"Non authentifié ou pas de famille"};this.isLoading=!0;try{const i=await fetch(`${t.public.apiBase}/api/v1/recipes/family`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.token}`},body:JSON.stringify({familyId:e.currentFamilyId,...a})}),r=await i.json();return i.ok?(this.familyRecipes.unshift(r.recipe),{success:!0,message:r.message,recipe:r.recipe}):{success:!1,message:r.message}}catch(i){return{success:!1,message:i.message}}finally{this.isLoading=!1}},async updateFamilyRecipe(a,t){const s=o(),e=c();if(!e.token)return{success:!1,message:"Non authentifié"};try{const i=await fetch(`${s.public.apiBase}/api/v1/recipes/family/${a}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.token}`},body:JSON.stringify(t)}),r=await i.json();if(i.ok){const f=this.familyRecipes.findIndex(u=>u.id===a);return f!==-1&&(this.familyRecipes[f]=r.recipe),{success:!0,message:r.message,recipe:r.recipe}}else return{success:!1,message:r.message}}catch(i){return{success:!1,message:i.message}}},async deleteFamilyRecipe(a){const t=o(),s=c();if(!s.token)return{success:!1,message:"Non authentifié"};try{const e=await fetch(`${t.public.apiBase}/api/v1/recipes/family/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${s.token}`}}),i=await e.json();return e.ok?(this.familyRecipes=this.familyRecipes.filter(r=>r.id!==a),{success:!0,message:i.message}):{success:!1,message:i.message}}catch(e){return{success:!1,message:e.message}}}}});export{g as u};
