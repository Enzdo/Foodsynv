import{_ as j}from"./DkiIfuYp.js";import{u as F}from"./DivAE8d_.js";import{u as S}from"./Ba0zKJDI.js";import{u as L}from"./2R3HMaYJ.js";import{g as N,m as V,r as $,p as B,q as g,c as o,a as e,s as m,l as a,b as D,w as T,F as b,v as y,t as u,o as i,d as z,n as x}from"./D1Xstx_g.js";const A={class:"px-4 pt-4 pb-24"},M={key:0,class:"card mb-4 bg-yellow-50 border-yellow-200"},U={class:"flex gap-2 mb-4 overflow-x-auto pb-2"},q=["onClick"],P={key:1,class:"text-center py-12"},G={key:2,class:"space-y-3"},R={class:"w-12 h-12 bg-white/50 rounded-xl flex items-center justify-center text-2xl"},H={class:"flex-1"},J={class:"font-medium text-gray-900"},K={class:"flex gap-2"},O=["onClick"],Q=["onClick"],W={key:0,class:"text-center py-12"},X={key:3,class:"card mt-6 bg-red-50 border-red-200"},Y={class:"flex items-center gap-3"},Z={class:"font-semibold text-red-800"},ie=N({__name:"expiring",setup(ee){const p=F(),d=S(),n=L(),h=V(),_=[{days:3,label:"3 jours"},{days:7,label:"7 jours"},{days:14,label:"14 jours"}],l=$(7);function w(t){return t===null?"":t<=0?"bg-red-100 border-red-300":t<=2?"bg-red-50 border-red-200":t<=5?"bg-orange-50 border-orange-200":"bg-yellow-50 border-yellow-200"}function v(t){return t===null?"text-gray-500":t<=0?"text-red-700":t<=2?"text-red-600":t<=5?"text-orange-600":"text-yellow-600"}function k(t){return t===null?"Pas de date":t<0?`Expir√© depuis ${Math.abs(t)} jour(s)`:t===0?"Expire aujourd'hui !":t===1?"Expire demain":`Expire dans ${t} jours`}async function C(t){await n.consumeItem(t),await n.fetchExpiringItems(l.value)}async function I(t){await n.deleteItem(t),await n.fetchExpiringItems(l.value)}async function c(){d.currentFamilyId&&await n.fetchExpiringItems(l.value)}return B(async()=>{if(p.init(),!p.isLoggedIn){h.push("/login");return}await d.fetchFamilies(),d.loadCurrentFamily(),await c()}),g(l,async()=>{await c()}),g(()=>d.currentFamilyId,async t=>{t&&await c()}),(t,s)=>{const E=j;return i(),o("div",A,[s[6]||(s[6]=e("header",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold text-gray-900"},"Bient√¥t p√©rim√©"),e("p",{class:"text-gray-500"},"Articles √† consommer rapidement")],-1)),a(d).hasFamily?m("",!0):(i(),o("div",M,[s[1]||(s[1]=e("p",{class:"text-yellow-800 text-sm"}," ‚ö†Ô∏è Vous devez d'abord cr√©er ou rejoindre une famille. ",-1)),D(E,{to:"/family",class:"text-primary-600 text-sm font-medium mt-2 inline-block"},{default:T(()=>[...s[0]||(s[0]=[z(" G√©rer mes familles ‚Üí ",-1)])]),_:1})])),e("div",U,[(i(),o(b,null,y(_,r=>e("button",{key:r.days,onClick:f=>l.value=r.days,class:x(["px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors",a(l)===r.days?"bg-red-500 text-white":"bg-gray-100 text-gray-600"])},u(r.label),11,q)),64))]),a(n).isLoading?(i(),o("div",P,[...s[2]||(s[2]=[e("div",{class:"animate-spin w-8 h-8 border-4 border-red-500 border-t-transparent rounded-full mx-auto mb-4"},null,-1),e("p",{class:"text-gray-500"},"Chargement...",-1)])])):(i(),o("div",G,[(i(!0),o(b,null,y(a(n).expiringItems,r=>(i(),o("div",{key:r.id,class:x(["card flex items-center gap-4",w(r.daysUntilExpiration)])},[e("div",R,u(r.emoji),1),e("div",H,[e("h3",J,u(r.name),1),e("p",{class:x(["text-sm font-medium",v(r.daysUntilExpiration)])},u(k(r.daysUntilExpiration)),3)]),e("div",K,[e("button",{onClick:f=>C(r.id),class:"p-2 bg-white rounded-lg shadow-sm",title:"Marquer comme consomm√©"}," ‚úÖ ",8,O),e("button",{onClick:f=>I(r.id),class:"p-2 bg-white rounded-lg shadow-sm",title:"Supprimer"}," üóëÔ∏è ",8,Q)])],2))),128)),a(n).expiringItems.length===0&&!a(n).isLoading?(i(),o("div",W,[...s[3]||(s[3]=[e("div",{class:"text-6xl mb-4"},"üéâ",-1),e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Aucun article p√©rim√©",-1),e("p",{class:"text-gray-500"},"Tous vos articles sont encore frais !",-1)])])):m("",!0)])),a(n).expiringItems.length>0?(i(),o("div",X,[e("div",Y,[s[5]||(s[5]=e("div",{class:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center"},[e("span",{class:"text-2xl"},"‚ö†Ô∏è")],-1)),e("div",null,[e("p",Z,u(a(n).expiringItems.length)+" article(s) √† surveiller",1),s[4]||(s[4]=e("p",{class:"text-sm text-red-600"},"Pensez √† les consommer rapidement",-1))])])])):m("",!0)])}}});export{ie as default};
