import{_ as B}from"./DkiIfuYp.js";import{g as G,m as Q,r as v,y as R,j as h,p as H,q as P,c as u,a as e,s as g,t as a,l as s,b as J,w as K,F as I,v as j,z as w,A as p,B as y,C as O,D,o as d,d as W,n as _}from"./D1Xstx_g.js";import{u as X}from"./DivAE8d_.js";import{u as Y}from"./Ba0zKJDI.js";import{u as Z}from"./2R3HMaYJ.js";const tt={class:"px-4 pt-4 pb-24"},et={class:"mb-6"},nt={class:"text-gray-500"},st={key:0,class:"card mb-4 bg-yellow-50 border-yellow-200"},lt={class:"flex gap-2 mb-4 overflow-x-auto pb-2"},it=["onClick"],ot={key:1,class:"text-center py-12"},at={key:2,class:"space-y-3"},rt=["onClick"],ut={class:"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center text-2xl"},dt={class:"flex-1"},mt={class:"font-medium text-gray-900"},pt={class:"text-right"},xt={class:"text-sm font-medium text-gray-900"},ft={class:"text-xs text-gray-500"},ct={key:0,class:"text-center py-12"},yt={class:"text-gray-500 mb-4"},vt={class:"bg-white w-full rounded-t-3xl p-6 max-h-[80vh] overflow-y-auto"},gt={class:"grid grid-cols-2 gap-3"},bt={class:"flex gap-3 pt-4"},wt=["disabled"],kt={class:"bg-white w-full rounded-t-3xl p-6"},Ct={class:"flex items-center gap-4 mb-6"},Lt={class:"w-16 h-16 bg-gray-100 rounded-xl flex items-center justify-center text-3xl"},ht={class:"text-xl font-bold text-gray-900"},It={class:"text-gray-500"},jt={class:"mb-4"},Dt={class:"flex gap-2 items-center"},_t={class:"text-sm text-gray-500 whitespace-nowrap"},Ft={class:"mb-6"},qt={class:"space-y-3"},zt=G({__name:"fridge",setup(Et){const k=X(),m=Y(),r=Z(),F=Q(),C=[{id:"fridge",label:"Frigo",icon:"â„ï¸"},{id:"freezer",label:"CongÃ©lateur",icon:"ðŸ§Š"},{id:"pantry",label:"Garde-manger",icon:"ðŸ "}],b=v("fridge"),x=v(!1),o=v(null),f=v(null),c=v(""),i=R({name:"",quantity:1,unit:"",expirationDate:"",storageLocation:"fridge"}),q=h(()=>C.find(l=>l.id===b.value)?.label||""),L=h(()=>r.items.filter(l=>l.storageLocation===b.value));function E(l){return r.items.filter(t=>t.storageLocation===l).length}function A(l){return l===null?"text-gray-500":l<=2?"text-red-600":l<=5?"text-orange-600":l<=7?"text-yellow-600":"text-gray-500"}function V(l){return l===null?"Pas de date":l<0?"ExpirÃ©":l===0?"Expire aujourd'hui":l===1?"Expire demain":`Expire dans ${l} jours`}function U(l){o.value=l,f.value=l.quantity,c.value=l.expirationDate||""}async function M(){(await r.addItem({name:i.name,quantity:i.quantity,unit:i.unit||void 0,expirationDate:i.expirationDate||void 0,storageLocation:i.storageLocation})).success&&(x.value=!1,i.name="",i.quantity=1,i.unit="",i.expirationDate="",i.storageLocation="fridge")}async function S(){o.value&&(await r.consumeItem(o.value.id),o.value=null)}async function z(){o.value&&(await r.deleteItem(o.value.id),o.value=null)}async function $(){if(!o.value||f.value===null)return;const l={quantity:f.value};c.value?l.expirationDate=c.value:l.expirationDate=null;const t=await r.updateItem(o.value.id,l);t.success&&t.item&&(o.value=t.item)}return H(async()=>{if(k.init(),!k.isLoggedIn){F.push("/login");return}await m.fetchFamilies(),m.loadCurrentFamily(),m.currentFamilyId&&await r.fetchItems()}),P(()=>m.currentFamilyId,async l=>{l&&await r.fetchItems()}),(l,t)=>{const N=B;return d(),u("div",tt,[e("header",et,[t[13]||(t[13]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Mon Frigo",-1)),e("p",nt,a(s(m).currentFamily?.name||"GÃ©rez votre inventaire"),1)]),s(m).hasFamily?g("",!0):(d(),u("div",st,[t[15]||(t[15]=e("p",{class:"text-yellow-800 text-sm"}," âš ï¸ Vous devez d'abord crÃ©er ou rejoindre une famille. ",-1)),J(N,{to:"/family",class:"text-primary-600 text-sm font-medium mt-2 inline-block"},{default:K(()=>[...t[14]||(t[14]=[W(" GÃ©rer mes familles â†’ ",-1)])]),_:1})])),e("div",lt,[(d(),u(I,null,j(C,n=>e("button",{key:n.id,onClick:T=>b.value=n.id,class:_(["px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors",s(b)===n.id?"bg-primary-500 text-white":"bg-gray-100 text-gray-600"])},a(n.icon)+" "+a(n.label)+" ("+a(E(n.id))+") ",11,it)),64))]),s(r).isLoading?(d(),u("div",ot,[...t[16]||(t[16]=[e("div",{class:"animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full mx-auto mb-4"},null,-1),e("p",{class:"text-gray-500"},"Chargement...",-1)])])):(d(),u("div",at,[(d(!0),u(I,null,j(s(L),n=>(d(),u("div",{key:n.id,class:"card flex items-center gap-4",onClick:T=>U(n)},[e("div",ut,a(n.emoji),1),e("div",dt,[e("h3",mt,a(n.name),1),e("p",{class:_(["text-sm",A(n.daysUntilExpiration)])},a(V(n.daysUntilExpiration)),3)]),e("div",pt,[e("span",xt,a(n.quantity),1),e("p",ft,a(n.unit||""),1)])],8,rt))),128)),s(L).length===0&&!s(r).isLoading?(d(),u("div",ct,[t[17]||(t[17]=e("div",{class:"text-6xl mb-4"},"ðŸ¥¡",-1)),t[18]||(t[18]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Aucun article",-1)),e("p",yt,"Ajoutez des articles Ã  votre "+a(s(q)),1),e("button",{onClick:t[0]||(t[0]=n=>x.value=!0),class:"btn-primary"},"Ajouter un article")])):g("",!0)])),s(m).hasFamily?(d(),u("button",{key:3,onClick:t[1]||(t[1]=n=>x.value=!0),class:"fixed bottom-24 right-4 w-14 h-14 bg-primary-500 rounded-full shadow-lg flex items-center justify-center text-white"},[...t[19]||(t[19]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])])):g("",!0),s(x)?(d(),u("div",{key:4,class:"fixed inset-0 bg-black/50 flex items-end z-50",onClick:t[8]||(t[8]=w(n=>x.value=!1,["self"]))},[e("div",vt,[t[26]||(t[26]=e("h2",{class:"text-xl font-bold text-gray-900 mb-4"},"Ajouter un article",-1)),e("form",{onSubmit:w(M,["prevent"]),class:"space-y-4"},[e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nom",-1)),p(e("input",{"onUpdate:modelValue":t[2]||(t[2]=n=>s(i).name=n),type:"text",required:"",class:"input",placeholder:"Ex: Lait"},null,512),[[y,s(i).name]])]),e("div",gt,[e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"QuantitÃ©",-1)),p(e("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>s(i).quantity=n),type:"number",min:"1",class:"input",placeholder:"1"},null,512),[[y,s(i).quantity,void 0,{number:!0}]])]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"UnitÃ©",-1)),p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=n=>s(i).unit=n),type:"text",class:"input",placeholder:"L, kg, pcs..."},null,512),[[y,s(i).unit]])])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Date d'expiration",-1)),p(e("input",{"onUpdate:modelValue":t[5]||(t[5]=n=>s(i).expirationDate=n),type:"date",class:"input"},null,512),[[y,s(i).expirationDate]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Emplacement",-1)),p(e("select",{"onUpdate:modelValue":t[6]||(t[6]=n=>s(i).storageLocation=n),class:"input"},[...t[24]||(t[24]=[e("option",{value:"fridge"},"â„ï¸ Frigo",-1),e("option",{value:"freezer"},"ðŸ§Š CongÃ©lateur",-1),e("option",{value:"pantry"},"ðŸ  Garde-manger",-1)])],512),[[O,s(i).storageLocation]])]),e("div",bt,[e("button",{type:"button",onClick:t[7]||(t[7]=n=>x.value=!1),class:"flex-1 btn-outline"}," Annuler "),e("button",{type:"submit",class:"flex-1 btn-primary",disabled:s(r).isLoading},a(s(r).isLoading?"Ajout...":"Ajouter"),9,wt)])],32)])])):g("",!0),s(o)?(d(),u("div",{key:5,class:"fixed inset-0 bg-black/50 flex items-end z-50",onClick:t[12]||(t[12]=w(n=>o.value=null,["self"]))},[e("div",kt,[e("div",Ct,[e("div",Lt,a(s(o).emoji),1),e("div",null,[e("h2",ht,a(s(o).name),1),e("p",It,a(s(o).quantity)+" "+a(s(o).unit||""),1)])]),e("div",jt,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"QuantitÃ© restante",-1)),e("div",Dt,[p(e("input",{"onUpdate:modelValue":t[9]||(t[9]=n=>D(f)?f.value=n:null),type:"number",step:"0.1",min:"0",class:"input flex-1"},null,512),[[y,s(f),void 0,{number:!0}]]),e("span",_t,a(s(o).unit||""),1)]),t[28]||(t[28]=e("p",{class:"text-xs text-gray-400 mt-1"},"Exemples : 4.5 L, 2 steaks restantsâ€¦",-1))]),e("div",Ft,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Date de pÃ©remption",-1)),p(e("input",{"onUpdate:modelValue":t[10]||(t[10]=n=>D(c)?c.value=n:null),type:"date",class:"input"},null,512),[[y,s(c)]]),t[30]||(t[30]=e("p",{class:"text-xs text-gray-400 mt-1"},"Laisse vide si le produit n'a pas de date prÃ©cise.",-1))]),e("div",qt,[e("button",{onClick:$,class:"w-full btn-primary py-3"}," ðŸ’¾ Mettre Ã  jour "),e("button",{onClick:S,class:"w-full btn-outline py-3"}," âœ… Marquer comme consommÃ© "),e("button",{onClick:z,class:"w-full btn-outline py-3 text-red-600 border-red-200"}," ðŸ—‘ï¸ Supprimer "),e("button",{onClick:t[11]||(t[11]=n=>o.value=null),class:"w-full btn-outline py-3"}," Annuler ")])])])):g("",!0)])}}});export{zt as default};
