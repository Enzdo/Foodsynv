import{_}from"./DkiIfuYp.js";import{g as k,m as w,r as C,p as I,q as F,c as n,a as e,s as i,t as c,l as r,b as L,w as S,A as j,B as P,I as B,D as V,F as A,v as M,J as N,o as a,d as z,n as m}from"./D1Xstx_g.js";import{u as q}from"./DivAE8d_.js";import{u as D}from"./Ba0zKJDI.js";import{u as R}from"./CuslmOQ6.js";const T={class:"px-4 pt-4 pb-24"},$={class:"flex items-center justify-between mb-6"},H={class:"text-gray-500"},K={key:0,class:"card mb-4 bg-yellow-50 border-yellow-200"},U={key:1,class:"flex gap-2 mb-6"},E=["disabled"],G={key:2,class:"text-center py-12"},J={key:3,class:"space-y-2"},O=["onClick"],Q={key:0,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},W={class:"flex-1"},X={key:0,class:"text-sm text-gray-500 ml-2"},Y={key:0,class:"px-2 py-0.5 bg-red-100 text-red-700 text-xs font-medium rounded-full"},Z=["onClick"],ee={key:0,class:"text-center py-12"},te={key:4,class:"card mt-6 bg-gray-50"},se={class:"flex justify-between items-center"},re={class:"font-semibold text-gray-900"},oe={class:"mt-2 h-2 bg-gray-200 rounded-full overflow-hidden"},ce=k({__name:"shopping",setup(ne){const p=q(),l=D(),s=R(),h=w(),u=C("");async function y(){if(!u.value.trim())return;(await s.addItem({name:u.value.trim()})).success&&(u.value="")}async function g(d){await s.toggleItem(d)}async function f(d){await s.deleteItem(d)}async function x(){await s.clearPurchased()}return I(async()=>{if(p.init(),!p.isLoggedIn){h.push("/login");return}await l.fetchFamilies(),l.loadCurrentFamily(),l.currentFamilyId&&await s.fetchItems()}),F(()=>l.currentFamilyId,async d=>{d&&await s.fetchItems()}),(d,t)=>{const v=_;return a(),n("div",T,[e("header",$,[e("div",null,[t[1]||(t[1]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Liste de courses",-1)),e("p",H,c(r(l).currentFamily?.name||"")+" - "+c(r(s).remainingCount)+" articles restants",1)]),r(s).purchasedItems.length>0?(a(),n("button",{key:0,onClick:x,class:"p-2 bg-gray-100 rounded-xl",title:"Supprimer les articles achetÃ©s"}," ðŸ—‘ï¸ ")):i("",!0)]),r(l).hasFamily?i("",!0):(a(),n("div",K,[t[3]||(t[3]=e("p",{class:"text-yellow-800 text-sm"}," âš ï¸ Vous devez d'abord crÃ©er ou rejoindre une famille. ",-1)),L(v,{to:"/family",class:"text-primary-600 text-sm font-medium mt-2 inline-block"},{default:S(()=>[...t[2]||(t[2]=[z(" GÃ©rer mes familles â†’ ",-1)])]),_:1})])),r(l).hasFamily?(a(),n("div",U,[j(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>V(u)?u.value=o:null),type:"text",placeholder:"Ajouter un article...",class:"input flex-1",onKeyup:B(y,["enter"])},null,544),[[P,r(u)]]),e("button",{onClick:y,class:"btn-primary px-4",disabled:r(s).isLoading},[...t[4]||(t[4]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])],8,E)])):i("",!0),r(s).isLoading?(a(),n("div",G,[...t[5]||(t[5]=[e("div",{class:"animate-spin w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full mx-auto mb-4"},null,-1),e("p",{class:"text-gray-500"},"Chargement...",-1)])])):(a(),n("div",J,[(a(!0),n(A,null,M(r(s).items,o=>(a(),n("div",{key:o.id,class:m(["card flex items-center gap-3 py-3",o.isPurchased?"opacity-50":""])},[e("button",{onClick:b=>g(o.id),class:m(["w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors",o.isPurchased?"bg-primary-500 border-primary-500":"border-gray-300"])},[o.isPurchased?(a(),n("svg",Q,[...t[6]||(t[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):i("",!0)],10,O),e("div",W,[e("span",{class:m(["font-medium",o.isPurchased?"line-through text-gray-400":"text-gray-900"])},c(o.name),3),o.quantity>1?(a(),n("span",X," x"+c(o.quantity),1)):i("",!0)]),o.priority==="high"?(a(),n("span",Y," Urgent ")):i("",!0),e("button",{onClick:b=>f(o.id),class:"p-1 text-gray-400 hover:text-red-500"},[...t[7]||(t[7]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Z)],2))),128)),r(s).items.length===0&&!r(s).isLoading?(a(),n("div",ee,[...t[8]||(t[8]=[e("div",{class:"text-6xl mb-4"},"ðŸ›’",-1),e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Liste vide",-1),e("p",{class:"text-gray-500"},"Ajoutez des articles Ã  votre liste de courses",-1)])])):i("",!0)])),r(s).items.length>0?(a(),n("div",te,[e("div",se,[t[9]||(t[9]=e("span",{class:"text-gray-600"},"Progression",-1)),e("span",re,c(r(s).purchasedItems.length)+"/"+c(r(s).items.length),1)]),e("div",oe,[e("div",{class:"h-full bg-primary-500 transition-all duration-300",style:N({width:`${r(s).progressPercentage}%`})},null,4)])])):i("",!0)])}}});export{ce as default};
